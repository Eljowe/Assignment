{"ast":null,"code":"import _defineProperty from\"C:/Koodi/Reaktor/Reaktor/birdnest/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import DroneService from\"../services/DroneService\";var distanceToNest=function distanceToNest(droneData,drone){//simple formula to calculate distance between drone and nest\nreturn Math.sqrt(Math.pow(250000-droneData[drone].children['8'].value,2)+Math.pow(250000-droneData[drone].children['7'].value,2));//simple formula of distance between two points\n};var FilterInsideNDZ=function FilterInsideNDZ(droneData){//filters drones that are within 100m from nest\nvar filteredDrones=Object.keys(droneData).filter(function(drone){return droneData[drone].closestToNest<100000;}).reduce(function(cur,drone){return Object.assign(cur,_defineProperty({},drone,droneData[drone]));},[]);return filteredDrones;};var TenMinuteFilter=function TenMinuteFilter(TenMinuteData,time){//filters drones that have last been seen over ten minutes ago\nObject.keys(TenMinuteData).map(function(obj){TenMinuteData[obj].timeOnList=time-TenMinuteData[obj].lastSeen;//timer starts counting from zero when the drone leaves the NDZ (timer resets to 0 when the drone is in NDZ)\n});var result=Object.keys(TenMinuteData).filter(function(obj){return time-TenMinuteData[obj].lastSeen<600000;}).reduce(function(cur,drone){return Object.assign(cur,_defineProperty({},drone,TenMinuteData[drone]));},[]);return result;};var DronesInNDZ10Minutes=function DronesInNDZ10Minutes(TenMinuteData,droneData,time){if(droneData.length>0){Object.keys(droneData).map(function(drone){TenMinuteData.filter(Boolean);if(!TenMinuteData.includes(undefined)){var index=TenMinuteData.findIndex(function(object){return object.serialNumber===droneData[drone].serialNumber;});if(index===-1){//Drone isn't in the ten minute buffer list and is therefore added\nDroneService.PilotInformation(droneData[drone].serialNumber)//Pilot information is fetched as the drone has violated NDZ\n.then(function(response){droneData[drone].pilotInformation=response;});TenMinuteData.push(droneData[drone]);}else{TenMinuteData[index].lastSeen=time;//if the drone is in NDZ, the 10 minute timer is reseted\nif(droneData[drone].closestToNest<TenMinuteData[index].closestToNest){//Closest recorded distance to the nest is left is saved\nTenMinuteData[index].closestToNest=droneData[drone].closestToNest;}}}});}return TenMinuteFilter(TenMinuteData,time);};export default{FilterInsideNDZ:FilterInsideNDZ,distanceToNest:distanceToNest,DronesInNDZ10Minutes:DronesInNDZ10Minutes,TenMinuteFilter:TenMinuteFilter};","map":{"version":3,"names":["DroneService","distanceToNest","droneData","drone","Math","sqrt","pow","children","value","FilterInsideNDZ","filteredDrones","Object","keys","filter","closestToNest","reduce","cur","assign","TenMinuteFilter","TenMinuteData","time","map","obj","timeOnList","lastSeen","result","DronesInNDZ10Minutes","length","Boolean","includes","undefined","index","findIndex","object","serialNumber","PilotInformation","then","response","pilotInformation","push"],"sources":["C:/Koodi/Reaktor/Reaktor/birdnest/src/components/FilterController.js"],"sourcesContent":["import DroneService from \"../services/DroneService\";\r\n\r\nconst distanceToNest = (droneData, drone) => { //simple formula to calculate distance between drone and nest\r\n    return Math.sqrt(Math.pow(250000-droneData[drone].children['8'].value, 2)+Math.pow(250000-droneData[drone].children['7'].value, 2)) //simple formula of distance between two points\r\n};\r\n\r\nconst FilterInsideNDZ = (droneData) => { //filters drones that are within 100m from nest\r\n    const filteredDrones = Object.keys(droneData)\r\n    .filter(drone => droneData[drone].closestToNest < 100000)\r\n    .reduce((cur, drone) => { return Object.assign(cur, { [drone]: droneData[drone] })}, []);\r\n    return filteredDrones\r\n};\r\n\r\nconst TenMinuteFilter = (TenMinuteData, time) => { //filters drones that have last been seen over ten minutes ago\r\n    Object.keys(TenMinuteData).map(obj => {\r\n        TenMinuteData[obj].timeOnList = time - TenMinuteData[obj].lastSeen; //timer starts counting from zero when the drone leaves the NDZ (timer resets to 0 when the drone is in NDZ)\r\n    })\r\n    const result = Object.keys(TenMinuteData).filter(obj => time-TenMinuteData[obj].lastSeen < 600000)\r\n    .reduce((cur, drone) => { return Object.assign(cur, { [drone]: TenMinuteData[drone] })}, []);\r\n    return result;\r\n}\r\n\r\nconst DronesInNDZ10Minutes = (TenMinuteData, droneData, time) => {\r\n    if (droneData.length > 0) {\r\n        Object.keys(droneData)\r\n        .map(drone => {\r\n            TenMinuteData.filter(Boolean)\r\n            if (!TenMinuteData.includes(undefined)) {\r\n                const index = TenMinuteData.findIndex(object => object.serialNumber === droneData[drone].serialNumber)\r\n                if (index === -1) { //Drone isn't in the ten minute buffer list and is therefore added\r\n                    DroneService.PilotInformation(droneData[drone].serialNumber) //Pilot information is fetched as the drone has violated NDZ\r\n                    .then(response => {\r\n                        droneData[drone].pilotInformation = response;\r\n                    })\r\n                    TenMinuteData.push(droneData[drone]);\r\n                } else {\r\n                    TenMinuteData[index].lastSeen = time; //if the drone is in NDZ, the 10 minute timer is reseted\r\n                    if (droneData[drone].closestToNest < TenMinuteData[index].closestToNest) { //Closest recorded distance to the nest is left is saved\r\n                        TenMinuteData[index].closestToNest=droneData[drone].closestToNest\r\n                    }\r\n                }\r\n        }})\r\n    }\r\n    return TenMinuteFilter(TenMinuteData, time);\r\n};\r\n\r\nexport default {\r\n    FilterInsideNDZ: FilterInsideNDZ,\r\n    distanceToNest: distanceToNest,\r\n    DronesInNDZ10Minutes: DronesInNDZ10Minutes,\r\n    TenMinuteFilter: TenMinuteFilter\r\n};"],"mappings":"yHAAA,MAAOA,aAAY,KAAM,0BAA0B,CAEnD,GAAMC,eAAc,CAAG,QAAjBA,eAAc,CAAIC,SAAS,CAAEC,KAAK,CAAK,CAAE;AAC3C,MAAOC,KAAI,CAACC,IAAI,CAACD,IAAI,CAACE,GAAG,CAAC,MAAM,CAACJ,SAAS,CAACC,KAAK,CAAC,CAACI,QAAQ,CAAC,GAAG,CAAC,CAACC,KAAK,CAAE,CAAC,CAAC,CAACJ,IAAI,CAACE,GAAG,CAAC,MAAM,CAACJ,SAAS,CAACC,KAAK,CAAC,CAACI,QAAQ,CAAC,GAAG,CAAC,CAACC,KAAK,CAAE,CAAC,CAAC,CAAC,CAAC;AACxI,CAAC,CAED,GAAMC,gBAAe,CAAG,QAAlBA,gBAAe,CAAIP,SAAS,CAAK,CAAE;AACrC,GAAMQ,eAAc,CAAGC,MAAM,CAACC,IAAI,CAACV,SAAS,CAAC,CAC5CW,MAAM,CAAC,SAAAV,KAAK,QAAID,UAAS,CAACC,KAAK,CAAC,CAACW,aAAa,CAAG,MAAM,GAAC,CACxDC,MAAM,CAAC,SAACC,GAAG,CAAEb,KAAK,CAAK,CAAE,MAAOQ,OAAM,CAACM,MAAM,CAACD,GAAG,oBAAKb,KAAK,CAAGD,SAAS,CAACC,KAAK,CAAC,EAAG,EAAC,CAAE,EAAE,CAAC,CACxF,MAAOO,eAAc,CACzB,CAAC,CAED,GAAMQ,gBAAe,CAAG,QAAlBA,gBAAe,CAAIC,aAAa,CAAEC,IAAI,CAAK,CAAE;AAC/CT,MAAM,CAACC,IAAI,CAACO,aAAa,CAAC,CAACE,GAAG,CAAC,SAAAC,GAAG,CAAI,CAClCH,aAAa,CAACG,GAAG,CAAC,CAACC,UAAU,CAAGH,IAAI,CAAGD,aAAa,CAACG,GAAG,CAAC,CAACE,QAAQ,CAAE;AACxE,CAAC,CAAC,CACF,GAAMC,OAAM,CAAGd,MAAM,CAACC,IAAI,CAACO,aAAa,CAAC,CAACN,MAAM,CAAC,SAAAS,GAAG,QAAIF,KAAI,CAACD,aAAa,CAACG,GAAG,CAAC,CAACE,QAAQ,CAAG,MAAM,GAAC,CACjGT,MAAM,CAAC,SAACC,GAAG,CAAEb,KAAK,CAAK,CAAE,MAAOQ,OAAM,CAACM,MAAM,CAACD,GAAG,oBAAKb,KAAK,CAAGgB,aAAa,CAAChB,KAAK,CAAC,EAAG,EAAC,CAAE,EAAE,CAAC,CAC5F,MAAOsB,OAAM,CACjB,CAAC,CAED,GAAMC,qBAAoB,CAAG,QAAvBA,qBAAoB,CAAIP,aAAa,CAAEjB,SAAS,CAAEkB,IAAI,CAAK,CAC7D,GAAIlB,SAAS,CAACyB,MAAM,CAAG,CAAC,CAAE,CACtBhB,MAAM,CAACC,IAAI,CAACV,SAAS,CAAC,CACrBmB,GAAG,CAAC,SAAAlB,KAAK,CAAI,CACVgB,aAAa,CAACN,MAAM,CAACe,OAAO,CAAC,CAC7B,GAAI,CAACT,aAAa,CAACU,QAAQ,CAACC,SAAS,CAAC,CAAE,CACpC,GAAMC,MAAK,CAAGZ,aAAa,CAACa,SAAS,CAAC,SAAAC,MAAM,QAAIA,OAAM,CAACC,YAAY,GAAKhC,SAAS,CAACC,KAAK,CAAC,CAAC+B,YAAY,GAAC,CACtG,GAAIH,KAAK,GAAK,CAAC,CAAC,CAAE,CAAE;AAChB/B,YAAY,CAACmC,gBAAgB,CAACjC,SAAS,CAACC,KAAK,CAAC,CAAC+B,YAAY,CAAE;AAAA,CAC5DE,IAAI,CAAC,SAAAC,QAAQ,CAAI,CACdnC,SAAS,CAACC,KAAK,CAAC,CAACmC,gBAAgB,CAAGD,QAAQ,CAChD,CAAC,CAAC,CACFlB,aAAa,CAACoB,IAAI,CAACrC,SAAS,CAACC,KAAK,CAAC,CAAC,CACxC,CAAC,IAAM,CACHgB,aAAa,CAACY,KAAK,CAAC,CAACP,QAAQ,CAAGJ,IAAI,CAAE;AACtC,GAAIlB,SAAS,CAACC,KAAK,CAAC,CAACW,aAAa,CAAGK,aAAa,CAACY,KAAK,CAAC,CAACjB,aAAa,CAAE,CAAE;AACvEK,aAAa,CAACY,KAAK,CAAC,CAACjB,aAAa,CAACZ,SAAS,CAACC,KAAK,CAAC,CAACW,aAAa,CACrE,CACJ,CACR,CAAC,CAAC,CAAC,CACP,CACA,MAAOI,gBAAe,CAACC,aAAa,CAAEC,IAAI,CAAC,CAC/C,CAAC,CAED,cAAe,CACXX,eAAe,CAAEA,eAAe,CAChCR,cAAc,CAAEA,cAAc,CAC9ByB,oBAAoB,CAAEA,oBAAoB,CAC1CR,eAAe,CAAEA,eACrB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}